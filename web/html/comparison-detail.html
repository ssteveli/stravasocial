
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-2"><img ng-src="{{comparison.compare_to_athlete.profile}}" onerror="handleMissingImage(this);"/></div>
        <div class="col-lg-3"><h2>{{comparison.compare_to_athlete.firstname}} {{comparison.compare_to_athlete.lastname}}</h2></div>
    </div>
</div>
<div class="container" style="margin-top: 20px;">
    <div class="row">
        <div class="col-lg-3">
            <div class="jumbotron" style="text-align: center;">
                <h3>Common Segments</h3>
                <h1>{{comparison.comparisons.length}}</h1>
            </div>
        </div>
        <div class="col-lg-3 winlosschart" style="text-align: center;">
            <h4>Win/Loss</h4>
            <nvd3-pie-chart
                    data="chartData"
                    id="winLossChart"
                    margin="10"
                    x="xFunction()"
                    y="yFunction()"
                    color="colorFunction()"
                    showLabels="true"
                    labelType="percent"
                    showLegend="false"
                    donut="true"
                    donutLabelsOutside="true">
                <svg height="225"></svg>
             </nvd3-pie-chart>
        </div>
        <div class="col-lg-6">
            <div class="container" ng-show="social_sharing">
                <div class="row">
                    <div class="col-sm-1" class="social">
                        <fb:share-button type="box_count" href="{{location.absUrl()}}"></fb:share-button>
                    </div>
                    <div class="col-sm-1" class="social">
                        <a href="https://twitter.com/share" class="twitter-share-button" data-lang="en" data-count="vertical">Tweet</a>
                    </div>
                    <div class="col-sm-1" class="social">
                        <div class="g-plus" data-action="share" data-annotation="vertical-bubble" data-height="60"></div>
                    </div>
                </div>
            </div>
            <table class="table" style="margin-top: 10px;">

                <tr>
                    <td>Started</td><td>{{comparison.started_ts*1000 | date:'medium'}}</td>
                </tr>
                <tr ng-show="comparison.completed_ts != undefined">
                    <td>Completed</td><td>{{comparison.completed_ts*1000 | date:'medium'}}</td>
                </tr>
                <tr>
                    <td>State</td><td>{{comparison.state}}</td>
                </tr>
                <tr>
                    <td>Activities Examined</td>
                    <td ng-show="comparison.state != 'Running'">{{comparison.total_activities}}</td>
                    <td ng-show="comparison.state == 'Running'">{{comparison.current_activity_idx}} of {{comparison.total_activities}}</td>
                </tr>
                <tr ng-show="total_time_difference">
                    <td>Total Time Difference</td>
                    <td><span ng-class="{'red' : (total_time_difference) < 0}">{{total_time_difference | secondstotime}}</span></td>
                </tr>
            </table>
        </div>
    </div>
</div>
<table ng-table class="table">
    <tr ng-repeat="c in comparison.comparisons">
        <td data-title="'Segment'"><a target="_blank" href="http://www.strava.com/segments/{{c.segment.id}}">{{c.segment.name}}</a></td>
        <td data-title="'Distance (' + comparison.compare_to_athlete.firstname + ' Distance)'">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-3">{{c.effort.distance | feet}}</div>
                    <div class="col-md-2">({{c.compared_to_effort.distance | feet}})</div>
                </div>
            </div>
        <td data-title="'Total Time (' + comparison.compare_to_athlete.firstname + ' Total Time) Difference'">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-3">{{c.effort.moving_time | seconds}}</div>
                    <div class="col-md-3">({{c.compared_to_effort.moving_time | seconds}})</div>
                    <div class="col-md-4"><span ng-class="{'red' : (c.compared_to_effort.moving_time - c.effort.moving_time) < 0}">{{c.compared_to_effort.moving_time - c.effort.moving_time}} seconds</span></div>
                </div>
            </div>
    </tr>
</table>

<p><a href="/comparisons">Return to Comparisons</a></p>